<ng-container *ngVar="(communitiesRD$ | async) as communitiesRD">
  @if (communitiesRD?.isLoading) {
    <ds-loading message="{{'loading.top-level-communities' | translate}}"></ds-loading>
  }
  @if (communitiesRD?.hasFailed) {
    <ds-error message="{{'error.top-level-communities' | translate}}"></ds-error>
  }
  @if (communitiesRD?.hasSucceeded && communities.length > 0) {
    <section class="categories-section enap-section">
      <h2 class="enap-section-title">Comunidades</h2>
      <div class="categories-grid">
        @for (community of communities; track community.id) {
          <a class="category-card" [routerLink]="['/communities', community.id]">
            <div class="category-icon">
              <i class="fas fa-university"></i>
            </div>
            <h3 class="category-name">{{ community.name }}</h3>
            @if (community.shortDescription) {
              <p class="category-description">{{ community.shortDescription }}</p>
            }
            <div class="category-meta">
              <span class="category-badge">
                <i class="fas fa-file-alt me-1"></i>
                {{ community.archivedItemsCount | number }} itens
              </span>
            </div>
          </a>
        }
      </div>
      <div class="categories-actions">
        <a class="btn-ver-todas" routerLink="/community-list">
          Ver todas as comunidades
        </a>
      </div>
    </section>
  }
</ng-container>
